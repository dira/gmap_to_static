<a href='javascript:(function(){ function is_object(a){return(a!=null)&&(typeof(a)=="object")}function has_property(a,b){return typeof(a[b])!="undefined"}function is_marker(a){return has_property(a,"infoWindow")&&has_property(a,"latlng")}function is_path(a){return has_property(a,"getVertex")}function explore(b,d,a,e){if(d(b)&&e.toString().indexOf(",0")>-1){throw (e)}if(e.length<a){for(var c in b){if(!is_object(b[c])){continue}if(has_property(b[c],"parentNode")){continue}explore(b[c],d,a,e.concat([c]))}}}function search_for(h,c){results=[];try{explore(map,h,c,[])}catch(a){container=map;var b=0;var j=a.length;for(var f=j;f>=0;f--){if(a[f]=="0"){b=f;break}}for(var f=0;f<b;f++){container=container[a[f]]}for(var g in container){var d=container[g];for(var f=b+1;f<j;f++){d=d[a[f]]}results.push(d)}}return results}function get_color(a){for(var c in a){if(a[c].indexOf&&a[c].indexOf(".png")>-1){var b=a[c];if(b.match(/^http/)){b=b.match("/[^/.]*.png")[0];b=b.substring(1,b.length-4);b=b.replace("-dot","");if(b=="pink"){b="0xCE579A"}if(b=="ltblue"){b="0x67DDDD"}return b}}}return""}function between(b,c,a){return a.lat<=b.lat()&&a.lng>=b.lng()&&a.lat>=c.lat()&&a.lng<=c.lng()}function get_zoom(){var a=document.getElementById("map").offsetWidth/map.getBounds().toSpan().x;return 3+Math.round(Math.LOG2E*Math.log(0.175*a))}function get_url(){var g=search_for(is_marker,3);var f=search_for(is_path,4);var c=[400,450];var d=get_zoom();var b="http://maps.google.com/maps/api/staticmap?zoom="+d+"&size="+c.join("x")+"&center="+map.getCenter().toUrlValue()+"&maptype=roadmap&sensor=false";var a=map.fromLatLngToDivPixel(map.getCenter());a.x-=Math.round(c[0]/2);a.y-=Math.round(c[1]/2);a=map.fromDivPixelToLatLng(a);var e=map.fromLatLngToDivPixel(map.getCenter());e.x+=Math.round(c[0]/2);e.y+=Math.round(c[1]/2);e=map.fromDivPixelToLatLng(e);b+="&"+g.map(function(h){var i=h.latlng;if(!between(a,e,i)){return null}return"markers=color:"+get_color(h)+"|"+i.lat.toFixed(2)+","+i.lng.toFixed(2)}).filter(function(h){return h!=null}).join("&");b+="&"+f.map(function(o){var m=[];var p=o.getVertexCount();var h=[];for(var l=0;l<p;l++){var k=o.getVertex(l);if(between(a,e,{lat:k.lat(),lng:k.lng()})){h.push(l,l+1,l-1)}}for(var l=0;l<p;l++){if(h.indexOf(l)==-1){continue}var k=o.getVertex(l);m.push(k.lat().toFixed(2)+","+k.lng().toFixed(2))}if(m.length<2){return null}var j=o.color=="#0000ff"?"":("color:"+o.color.replace("#","0x")+"|");return"path="+j+m.join("|")}).filter(function(h){return h!=null}).join("&");return b}map=window.gApplication.getMap();window.open(get_url(),"_blank"); })()'>make static map!</a>
