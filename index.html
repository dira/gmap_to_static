<a href='javascript:(function(){ function is_object(a){return(a!=null)&&(typeof(a)=="object")}function has_property(a,b){return typeof(a[b])!="undefined"}function is_marker(a){return has_property(a,"infoWindow")&&has_property(a,"latlng")}function explore(a,c){if(is_marker(a)&&c.toString().indexOf(",0")>-1){throw (c)}if(c.length<max_level){for(var b in a){if(!is_object(a[b])){continue}if(has_property(a[b],"parentNode")){continue}explore(a[b],c.concat([b]))}}}function get_color(a){for(var c in a){if(a[c].indexOf&&a[c].indexOf(".png")>-1){var b=a[c];if(b.match(/^http/)){b=b.match("/[^/.]*.png")[0];b=b.substring(1,b.length-4);b=b.replace("-dot","");if(b=="pink"){b="0xCE579A"}if(b=="ltblue"){b="0x67DDDD"}return b}}}return""}function get_zoom(){var a=document.getElementById("map").offsetWidth/map.getBounds().toSpan().x;return 3+Math.round(Math.LOG2E*Math.log(0.175*a))}map=window.gApplication.getMap();max_level=3;markers=[];try{explore(map,[])}catch(stack){container=map;for(var i=0;i<stack.length;i++){if(stack[i]=="0"){break}container=container[stack[i]]}for(var m in container){var marker=container[m];for(var j=i+1;j<stack.length;j++){marker=marker[stack[j]]}markers.push(marker)}}size="350x450";url="http://maps.google.com/maps/api/staticmap?zoom="+get_zoom()+"&size="+size+"&center="+map.getCenter().toUrlValue()+"&maptype=roadmap&sensor=false";for(var i=0;i<markers.length;i++){var marker=markers[i];try{var latLng=marker.latlng;url+="&markers=color:"+get_color(marker)+"|"+latLng.lat.toFixed(2)+","+latLng.lng.toFixed(2)}catch(err){}}window.open(url,"_blank"); })()'>make static map!</a>
